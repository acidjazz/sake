var Spa;

Spa = {
  instagram: false,
  original: null,
  page: null,
  options: {
    work: '/work/',
    studio: '/studio/',
    contact: '/contact/'
  },
  i: function() {
    console.log('Spa.i()');
    Spa.handlers();
    Spa.page = Spa.original = location.pathname;
    Spa.activate(Spa.page);
    return Preimg($('#container > #inner'), function(complete) {
      console.log('hi', Math.round(100 * (1 - complete)) / 100);
      return $('.spinner > .complete').css('opacity', Math.round(100 * (1 - complete)) / 100);
    }, function(done) {
      return setTimeout(function() {
        _.off('.spinner');
        $('.spinner > .complete').css('opacity', 1);
        return _.on('#container > #inner');
      }, 1000);
    });
  },
  handlers: function() {
    $('header > .inner > .menu > ul > li > a, header > .inner > a.logo').on('click', Spa.menuHandler);
    $(window).bind('popstate', Spa.pop);
    $('#container > #inner').on('click', '.page.work > .tiles > a.tile', Spa.tileHandler);
    return $('#container > #inner').on('click', '.page.detail > .submenu > a', Spa.submenuHandler);
  },
  tileHandler: function(e) {
    var page;
    e.preventDefault();
    page = $(this).attr('href');
    if (page === void 0) {
      return true;
    }
    if (page === location.pathname) {
      return true;
    }
    return Spa.load(page, function() {
      return Spa.push();
    });
  },
  submenuHandler: function(e) {
    var page;
    e.preventDefault();
    page = $(this).attr('href');
    if (page === void 0) {
      return true;
    }
    if (page === location.pathname) {
      return true;
    }
    _.on('.spinner');
    _.off('.submenu a');
    _.on(".submenu a.item_" + (page.replace('work', '').replace(/\//g, '')));
    return Spa.load(page, '.details', '#container > #inner .details', function() {
      return Spa.push();
    });
  },
  menuHandler: function(e) {
    var page;
    e.preventDefault();
    page = $(this).data('page');
    if (page === void 0) {
      return true;
    }
    if (page === location.pathname) {
      return true;
    }
    return Spa.load(page, '#inner', '#container > #inner', function() {
      return Spa.push();
    });
  },
  activate: function() {
    var k, ref, results, v;
    _.off('header > .inner > .menu > ul > li > a');
    ref = Spa.options;
    results = [];
    for (k in ref) {
      v = ref[k];
      if (Spa.page.match(v) !== null) {
        results.push(_.on("header > .inner > .menu > ul > li > a.option_" + k));
      } else {
        results.push(void 0);
      }
    }
    return results;
  },
  load: function(page, find, replace, cb) {
    _.on('.spinner');
    return $.get(page).success(function(result) {
      var html;
      html = $(result).filter('#container').find(find);
      return Preimg(html, function(complete) {
        return console.log(complete);
      }, function(done) {
        return setTimeout(function() {
          _.off('.spinner');
          $('.spinner > .complete').css('opacity', 1);
          $(replace).replaceWith(html);
          _.on('#container > #inner');
          Spa.page = page;
          if (typeof cb === "function") {
            cb();
          }
          return Spa.activate();
        }, 1000);
      });
    });
  },
  push: function() {
    return history.pushState({
      url: Spa.page
    }, "Design Sake Studio - " + Spa.page, Spa.page);
  },
  pop: function(e) {
    if (e.originalEvent.state === null) {
      return Spa.load(Spa.original);
    } else {
      return Spa.load(e.originalEvent.state.url);
    }
  }
};

//# sourceMappingURL=data:application/json;base64,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InNwYS5qcyIsInNvdXJjZVJvb3QiOiIvc291cmNlLyIsInNvdXJjZXNDb250ZW50IjpbIlxuU3BhID1cblxuICBpbnN0YWdyYW06IGZhbHNlXG4gIG9yaWdpbmFsOiBudWxsXG4gIHBhZ2U6IG51bGxcbiAgb3B0aW9uczpcbiAgICB3b3JrOiAnL3dvcmsvJ1xuICAgIHN0dWRpbzogJy9zdHVkaW8vJ1xuICAgIGNvbnRhY3Q6ICcvY29udGFjdC8nXG5cbiAgaTogLT5cbiAgICBjb25zb2xlLmxvZyAnU3BhLmkoKSdcbiAgICBTcGEuaGFuZGxlcnMoKVxuXG4gICAgU3BhLnBhZ2UgPSBTcGEub3JpZ2luYWwgPSBsb2NhdGlvbi5wYXRobmFtZVxuICAgIFNwYS5hY3RpdmF0ZSBTcGEucGFnZVxuXG4gICAgUHJlaW1nICQoJyNjb250YWluZXIgPiAjaW5uZXInKSwgKGNvbXBsZXRlKSAtPlxuICAgICAgY29uc29sZS5sb2cgJ2hpJywgTWF0aC5yb3VuZCgxMDAqKDEtY29tcGxldGUpKS8xMDBcbiAgICAgICQoJy5zcGlubmVyID4gLmNvbXBsZXRlJykuY3NzICdvcGFjaXR5JywgTWF0aC5yb3VuZCgxMDAqKDEtY29tcGxldGUpKS8xMDBcbiAgICAsIChkb25lKSAtPlxuICAgICAgc2V0VGltZW91dCAtPlxuICAgICAgICBfLm9mZiAnLnNwaW5uZXInXG4gICAgICAgICQoJy5zcGlubmVyID4gLmNvbXBsZXRlJykuY3NzICdvcGFjaXR5JywgMVxuICAgICAgICBfLm9uICcjY29udGFpbmVyID4gI2lubmVyJ1xuICAgICAgLCAxMDAwXG5cbiAgaGFuZGxlcnM6IC0+XG5cbiAgICAjIG1haW4gbWVudVxuICAgICQoJ2hlYWRlciA+IC5pbm5lciA+IC5tZW51ID4gdWwgPiBsaSA+IGEsIGhlYWRlciA+IC5pbm5lciA+IGEubG9nbycpLm9uICdjbGljaycsIFNwYS5tZW51SGFuZGxlclxuXG4gICAgIyBiYWNrIGJ1dHRvblxuICAgICQod2luZG93KS5iaW5kICdwb3BzdGF0ZScsIFNwYS5wb3BcblxuICAgICMgd29yayB0aWxlIG1lbnVcbiAgICAkKCcjY29udGFpbmVyID4gI2lubmVyJykub24gJ2NsaWNrJywgJy5wYWdlLndvcmsgPiAudGlsZXMgPiBhLnRpbGUnLCBTcGEudGlsZUhhbmRsZXJcbiAgICAjIHdvcmsgc3ViIG1lbnVcbiAgICAkKCcjY29udGFpbmVyID4gI2lubmVyJykub24gJ2NsaWNrJywgJy5wYWdlLmRldGFpbCA+IC5zdWJtZW51ID4gYScsIFNwYS5zdWJtZW51SGFuZGxlclxuXG5cbiAgdGlsZUhhbmRsZXI6IChlKSAtPlxuXG4gICAgZS5wcmV2ZW50RGVmYXVsdCgpXG5cbiAgICBwYWdlID0gJCh0aGlzKS5hdHRyICdocmVmJ1xuXG4gICAgcmV0dXJuIHRydWUgaWYgcGFnZSBpcyB1bmRlZmluZWRcbiAgICByZXR1cm4gdHJ1ZSBpZiBwYWdlIGlzIGxvY2F0aW9uLnBhdGhuYW1lXG5cbiAgICBTcGEubG9hZCBwYWdlLCAtPlxuICAgICAgU3BhLnB1c2goKVxuXG4gIHN1Ym1lbnVIYW5kbGVyOiAoZSkgLT5cblxuICAgIGUucHJldmVudERlZmF1bHQoKVxuXG4gICAgcGFnZSA9ICQodGhpcykuYXR0ciAnaHJlZidcblxuICAgIHJldHVybiB0cnVlIGlmIHBhZ2UgaXMgdW5kZWZpbmVkXG4gICAgcmV0dXJuIHRydWUgaWYgcGFnZSBpcyBsb2NhdGlvbi5wYXRobmFtZVxuXG4gICAgXy5vbiAnLnNwaW5uZXInXG4gICAgXy5vZmYgJy5zdWJtZW51IGEnXG4gICAgXy5vbiBcIi5zdWJtZW51IGEuaXRlbV8je3BhZ2UucmVwbGFjZSgnd29yaycsICcnKS5yZXBsYWNlKC9cXC8vZywgJycpfVwiXG5cbiAgICBTcGEubG9hZCBwYWdlLCAnLmRldGFpbHMnLCAnI2NvbnRhaW5lciA+ICNpbm5lciAuZGV0YWlscycsIC0+XG4gICAgICBTcGEucHVzaCgpXG4gICAgXG4gIG1lbnVIYW5kbGVyOiAoZSkgLT5cblxuICAgIGUucHJldmVudERlZmF1bHQoKVxuXG4gICAgcGFnZSA9ICQodGhpcykuZGF0YSAncGFnZSdcblxuICAgIHJldHVybiB0cnVlIGlmIHBhZ2UgaXMgdW5kZWZpbmVkXG4gICAgcmV0dXJuIHRydWUgaWYgcGFnZSBpcyBsb2NhdGlvbi5wYXRobmFtZVxuXG4gICAgU3BhLmxvYWQgcGFnZSwgJyNpbm5lcicsICcjY29udGFpbmVyID4gI2lubmVyJywgLT5cbiAgICAgIFNwYS5wdXNoKClcblxuICBhY3RpdmF0ZTogLT5cbiAgICBfLm9mZiAnaGVhZGVyID4gLmlubmVyID4gLm1lbnUgPiB1bCA+IGxpID4gYSdcbiAgICBmb3IgaywgdiBvZiBTcGEub3B0aW9uc1xuICAgICAgaWYgU3BhLnBhZ2UubWF0Y2godikgaXNudCBudWxsXG4gICAgICAgIF8ub24gXCJoZWFkZXIgPiAuaW5uZXIgPiAubWVudSA+IHVsID4gbGkgPiBhLm9wdGlvbl8je2t9XCJcblxuICBsb2FkOiAocGFnZSwgZmluZCwgcmVwbGFjZSwgY2IpIC0+XG5cbiAgICBfLm9uICcuc3Bpbm5lcidcbiAgICBcbiAgICAkLmdldCBwYWdlXG4gICAgICAuc3VjY2VzcyAocmVzdWx0KSAtPlxuICAgICAgICBodG1sID0gJChyZXN1bHQpLmZpbHRlcignI2NvbnRhaW5lcicpLmZpbmQoZmluZClcbiAgICAgICAgUHJlaW1nIGh0bWwsIChjb21wbGV0ZSkgLT5cbiAgICAgICAgICBjb25zb2xlLmxvZyBjb21wbGV0ZVxuICAgICAgICAsIChkb25lKSAtPlxuICAgICAgICAgIHNldFRpbWVvdXQgLT5cbiAgICAgICAgICAgIF8ub2ZmICcuc3Bpbm5lcidcbiAgICAgICAgICAgICQoJy5zcGlubmVyID4gLmNvbXBsZXRlJykuY3NzICdvcGFjaXR5JywgMVxuICAgICAgICAgICAgJChyZXBsYWNlKS5yZXBsYWNlV2l0aCBodG1sXG4gICAgICAgICAgICBfLm9uICcjY29udGFpbmVyID4gI2lubmVyJ1xuICAgICAgICAgICAgU3BhLnBhZ2UgPSBwYWdlXG4gICAgICAgICAgICBjYj8oKVxuICAgICAgICAgICAgU3BhLmFjdGl2YXRlKClcbiAgICAgICAgICAsIDEwMDBcblxuICBwdXNoOiAtPlxuICAgIGhpc3RvcnkucHVzaFN0YXRlIHt1cmw6IFNwYS5wYWdlfSwgXCJEZXNpZ24gU2FrZSBTdHVkaW8gLSAje1NwYS5wYWdlfVwiLCBTcGEucGFnZVxuICAgICAgICBcbiAgcG9wOiAoZSkgLT5cbiAgICBpZiBlLm9yaWdpbmFsRXZlbnQuc3RhdGUgaXMgbnVsbFxuICAgICAgU3BhLmxvYWQgU3BhLm9yaWdpbmFsXG4gICAgZWxzZVxuICAgICAgU3BhLmxvYWQgZS5vcmlnaW5hbEV2ZW50LnN0YXRlLnVybFxuXG4iXX0=
