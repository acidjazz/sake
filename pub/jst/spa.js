var Spa;

Spa = {
  original: null,
  page: null,
  options: {
    work: '/work/',
    studio: '/studio/',
    contact: '/contact/'
  },
  i: function() {
    console.log('Spa.i()');
    Spa.handlers();
    Spa.page = Spa.original = location.pathname;
    Spa.activate(Spa.page);
    return Preimg($('#container > #inner'), function(complete) {
      return console.log(complete);
    }, function(done) {
      return setTimeout(function() {
        _.off('.spinner');
        return _.on('#container > #inner');
      }, 1000);
    });
  },
  handlers: function() {
    $('header > .inner > .menu > ul > li > a, header > .inner > a.logo').on('click', Spa.menuHandler);
    $(window).bind('popstate', Spa.pop);
    $('#container > #inner').on('click', '.page.work > .tiles > a.tile', Spa.tileHandler);
    return $('#container > #inner').on('click', '.page.detail > .submenu > a', Spa.submenuHandler);
  },
  tileHandler: function(e) {
    var page;
    e.preventDefault();
    page = $(this).attr('href');
    if (page === void 0) {
      return true;
    }
    if (page === location.pathname) {
      return true;
    }
    return Spa.load(page, function() {
      return Spa.push();
    });
  },
  submenuHandler: function(e) {
    var page;
    e.preventDefault();
    page = $(this).attr('href');
    if (page === void 0) {
      return true;
    }
    if (page === location.pathname) {
      return true;
    }
    _.on('.spinner');
    _.off('.submenu a');
    _.on(".submenu a.item_" + (page.replace('work', '').replace(/\//g, '')));
    console.log(".submenu a.item_" + (page.replace('work', '').replace(/\//g, '')));
    return $.get(page).success(function(result) {
      var html;
      html = $(result).filter('#container').find('#inner').find('.details').html();
      return Preimg(html, function(complete) {
        return console.log(complete);
      }, function(done) {
        return setTimeout(function() {
          _.off('.spinner');
          $('#container > #inner .details').html(html);
          Spa.page = page;
          if (typeof cb === "function") {
            cb();
          }
          Spa.activate();
          return Spa.push();
        }, 1000);
      });
    });
  },
  menuHandler: function(e) {
    var page;
    e.preventDefault();
    page = $(this).data('page');
    if (page === void 0) {
      return true;
    }
    if (page === location.pathname) {
      return true;
    }
    return Spa.load(page, function() {
      return Spa.push();
    });
  },
  activate: function() {
    var k, ref, results, v;
    _.off('header > .inner > .menu > ul > li > a');
    ref = Spa.options;
    results = [];
    for (k in ref) {
      v = ref[k];
      if (Spa.page.match(v) !== null) {
        results.push(_.on("header > .inner > .menu > ul > li > a.option_" + k));
      } else {
        results.push(void 0);
      }
    }
    return results;
  },
  load: function(page, cb) {
    _.on('.spinner');
    return $.get(page).success(function(result) {
      var html;
      html = $(result).filter('#container').find('#inner')[0];
      return Preimg(html, function(complete) {
        return console.log(complete);
      }, function(done) {
        return setTimeout(function() {
          _.off('.spinner');
          $('#container > #inner').html(html);
          Spa.page = page;
          if (typeof cb === "function") {
            cb();
          }
          return Spa.activate();
        }, 1000);
      });
    });
  },
  push: function() {
    return history.pushState({
      url: Spa.page
    }, "Design Sake Studio - " + Spa.page, Spa.page);
  },
  pop: function(e) {
    if (e.originalEvent.state === null) {
      return Spa.load(Spa.original);
    } else {
      return Spa.load(e.originalEvent.state.url);
    }
  }
};

//# sourceMappingURL=data:application/json;base64,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Q0UsR0FBRyxDQUFDLElBQUosQ0FBUyxHQUFHLENBQUMsUUFBYixFQURGO0tBQUEsTUFBQTthQUdFLEdBQUcsQ0FBQyxJQUFKLENBQVMsQ0FBQyxDQUFDLGFBQWEsQ0FBQyxLQUFLLENBQUMsR0FBL0IsRUFIRjs7RUFERyxDQXhITCIsImZpbGUiOiJzcGEuanMiLCJzb3VyY2VSb290IjoiL3NvdXJjZS8iLCJzb3VyY2VzQ29udGVudCI6WyJcblNwYSA9XG5cbiAgb3JpZ2luYWw6IG51bGxcbiAgcGFnZTogbnVsbFxuICBvcHRpb25zOlxuICAgIHdvcms6ICcvd29yay8nXG4gICAgc3R1ZGlvOiAnL3N0dWRpby8nXG4gICAgY29udGFjdDogJy9jb250YWN0LydcblxuICBpOiAtPlxuICAgIGNvbnNvbGUubG9nICdTcGEuaSgpJ1xuICAgIFNwYS5oYW5kbGVycygpXG5cbiAgICBTcGEucGFnZSA9IFNwYS5vcmlnaW5hbCA9IGxvY2F0aW9uLnBhdGhuYW1lXG4gICAgU3BhLmFjdGl2YXRlIFNwYS5wYWdlXG5cbiAgICBQcmVpbWcgJCgnI2NvbnRhaW5lciA+ICNpbm5lcicpLCAoY29tcGxldGUpIC0+XG4gICAgICAgICAgY29uc29sZS5sb2cgY29tcGxldGVcbiAgICAgICAgLCAoZG9uZSkgLT5cbiAgICAgICAgICBzZXRUaW1lb3V0IC0+XG4gICAgICAgICAgICBfLm9mZiAnLnNwaW5uZXInXG4gICAgICAgICAgICBfLm9uICcjY29udGFpbmVyID4gI2lubmVyJ1xuICAgICAgICAgICwgMTAwMFxuXG5cblxuICBoYW5kbGVyczogLT5cblxuICAgICMgbWFpbiBtZW51XG4gICAgJCgnaGVhZGVyID4gLmlubmVyID4gLm1lbnUgPiB1bCA+IGxpID4gYSwgaGVhZGVyID4gLmlubmVyID4gYS5sb2dvJykub24gJ2NsaWNrJywgU3BhLm1lbnVIYW5kbGVyXG5cbiAgICAjIGJhY2sgYnV0dG9uXG4gICAgJCh3aW5kb3cpLmJpbmQgJ3BvcHN0YXRlJywgU3BhLnBvcFxuXG4gICAgIyB3b3JrIHRpbGUgbWVudVxuICAgICQoJyNjb250YWluZXIgPiAjaW5uZXInKS5vbiAnY2xpY2snLCAnLnBhZ2Uud29yayA+IC50aWxlcyA+IGEudGlsZScsIFNwYS50aWxlSGFuZGxlclxuICAgICMgd29yayBzdWIgbWVudVxuICAgICQoJyNjb250YWluZXIgPiAjaW5uZXInKS5vbiAnY2xpY2snLCAnLnBhZ2UuZGV0YWlsID4gLnN1Ym1lbnUgPiBhJywgU3BhLnN1Ym1lbnVIYW5kbGVyXG5cblxuICB0aWxlSGFuZGxlcjogKGUpIC0+XG5cbiAgICBlLnByZXZlbnREZWZhdWx0KClcblxuICAgIHBhZ2UgPSAkKHRoaXMpLmF0dHIgJ2hyZWYnXG5cbiAgICByZXR1cm4gdHJ1ZSBpZiBwYWdlIGlzIHVuZGVmaW5lZFxuICAgIHJldHVybiB0cnVlIGlmIHBhZ2UgaXMgbG9jYXRpb24ucGF0aG5hbWVcblxuICAgIFNwYS5sb2FkIHBhZ2UsIC0+XG4gICAgICBTcGEucHVzaCgpXG5cblxuICBzdWJtZW51SGFuZGxlcjogKGUpIC0+XG5cbiAgICBlLnByZXZlbnREZWZhdWx0KClcblxuICAgIHBhZ2UgPSAkKHRoaXMpLmF0dHIgJ2hyZWYnXG5cbiAgICByZXR1cm4gdHJ1ZSBpZiBwYWdlIGlzIHVuZGVmaW5lZFxuICAgIHJldHVybiB0cnVlIGlmIHBhZ2UgaXMgbG9jYXRpb24ucGF0aG5hbWVcblxuICAgIF8ub24gJy5zcGlubmVyJ1xuICAgIF8ub2ZmICcuc3VibWVudSBhJ1xuICAgIF8ub24gXCIuc3VibWVudSBhLml0ZW1fI3twYWdlLnJlcGxhY2UoJ3dvcmsnLCAnJykucmVwbGFjZSgvXFwvL2csICcnKX1cIlxuICAgIGNvbnNvbGUubG9nIFwiLnN1Ym1lbnUgYS5pdGVtXyN7cGFnZS5yZXBsYWNlKCd3b3JrJywgJycpLnJlcGxhY2UoL1xcLy9nLCAnJyl9XCJcbiAgICBcbiAgICAkLmdldCBwYWdlXG4gICAgICAuc3VjY2VzcyAocmVzdWx0KSAtPlxuICAgICAgICBodG1sID0gJChyZXN1bHQpLmZpbHRlcignI2NvbnRhaW5lcicpLmZpbmQoJyNpbm5lcicpLmZpbmQoJy5kZXRhaWxzJykuaHRtbCgpXG4gICAgICAgIFByZWltZyBodG1sLCAoY29tcGxldGUpIC0+XG4gICAgICAgICAgY29uc29sZS5sb2cgY29tcGxldGVcbiAgICAgICAgLCAoZG9uZSkgLT5cbiAgICAgICAgICBzZXRUaW1lb3V0IC0+XG4gICAgICAgICAgICBfLm9mZiAnLnNwaW5uZXInXG4gICAgICAgICAgICAkKCcjY29udGFpbmVyID4gI2lubmVyIC5kZXRhaWxzJykuaHRtbCBodG1sXG4gICAgICAgICAgICBTcGEucGFnZSA9IHBhZ2VcbiAgICAgICAgICAgIGNiPygpXG4gICAgICAgICAgICBTcGEuYWN0aXZhdGUoKVxuICAgICAgICAgICAgU3BhLnB1c2goKVxuICAgICAgICAgICwgMTAwMFxuXG4gIG1lbnVIYW5kbGVyOiAoZSkgLT5cblxuICAgIGUucHJldmVudERlZmF1bHQoKVxuXG4gICAgcGFnZSA9ICQodGhpcykuZGF0YSAncGFnZSdcblxuICAgIHJldHVybiB0cnVlIGlmIHBhZ2UgaXMgdW5kZWZpbmVkXG4gICAgcmV0dXJuIHRydWUgaWYgcGFnZSBpcyBsb2NhdGlvbi5wYXRobmFtZVxuXG5cbiAgICBTcGEubG9hZCBwYWdlLCAtPlxuICAgICAgU3BhLnB1c2goKVxuXG4gIGFjdGl2YXRlOiAtPlxuICAgIF8ub2ZmICdoZWFkZXIgPiAuaW5uZXIgPiAubWVudSA+IHVsID4gbGkgPiBhJ1xuICAgIGZvciBrLCB2IG9mIFNwYS5vcHRpb25zXG4gICAgICBpZiBTcGEucGFnZS5tYXRjaCh2KSBpc250IG51bGxcbiAgICAgICAgXy5vbiBcImhlYWRlciA+IC5pbm5lciA+IC5tZW51ID4gdWwgPiBsaSA+IGEub3B0aW9uXyN7a31cIlxuXG4gIGxvYWQ6IChwYWdlLCBjYikgLT5cblxuICAgIF8ub24gJy5zcGlubmVyJ1xuICAgIFxuICAgICQuZ2V0IHBhZ2VcbiAgICAgIC5zdWNjZXNzIChyZXN1bHQpIC0+XG4gICAgICAgIGh0bWwgPSAkKHJlc3VsdCkuZmlsdGVyKCcjY29udGFpbmVyJykuZmluZCgnI2lubmVyJylbMF1cbiAgICAgICAgUHJlaW1nIGh0bWwsIChjb21wbGV0ZSkgLT5cbiAgICAgICAgICBjb25zb2xlLmxvZyBjb21wbGV0ZVxuICAgICAgICAsIChkb25lKSAtPlxuICAgICAgICAgIHNldFRpbWVvdXQgLT5cbiAgICAgICAgICAgIF8ub2ZmICcuc3Bpbm5lcidcbiAgICAgICAgICAgICQoJyNjb250YWluZXIgPiAjaW5uZXInKS5odG1sIGh0bWxcbiAgICAgICAgICAgIFNwYS5wYWdlID0gcGFnZVxuICAgICAgICAgICAgY2I/KClcbiAgICAgICAgICAgIFNwYS5hY3RpdmF0ZSgpXG4gICAgICAgICAgLCAxMDAwXG5cbiAgcHVzaDogLT5cbiAgICBoaXN0b3J5LnB1c2hTdGF0ZSB7dXJsOiBTcGEucGFnZX0sIFwiRGVzaWduIFNha2UgU3R1ZGlvIC0gI3tTcGEucGFnZX1cIiwgU3BhLnBhZ2VcbiAgICAgICAgXG4gIHBvcDogKGUpIC0+XG4gICAgaWYgZS5vcmlnaW5hbEV2ZW50LnN0YXRlIGlzIG51bGxcbiAgICAgIFNwYS5sb2FkIFNwYS5vcmlnaW5hbFxuICAgIGVsc2VcbiAgICAgIFNwYS5sb2FkIGUub3JpZ2luYWxFdmVudC5zdGF0ZS51cmxcblxuIl19
